/*
 * main.c
 * The interface to a pre-trained time-predictable meta neural network, generated by MNN2C.py.
 * Expects input from stdin in the following form:
 *   One integer (the number of inputs to feed into the meta NN)
 *   For each test case, one long space-delimited string, with one entry per network input (read in row-major order).
 */

#include <stdbool.h>
#include <stdio.h>
#include <stdlib.h>
#include "mnn.h"


void print_output_arr(NN_NUM_TYPE output_arr[MNN_OUTPUT_DIM_0])
{
    double write_var;
    int dim_0_index;
    
    for (dim_0_index = 0; dim_0_index < MNN_OUTPUT_DIM_0; dim_0_index++)
    {
        write_var = TO_DBL(output_arr[dim_0_index]);
        printf("%lf ", write_var);
    }

    printf("\n");
}


double tmp_input[MNN_INPUT_DIM_0][MNN_INPUT_DIM_1][MNN_INPUT_DIM_2];
void read_input_data(NN_NUM_TYPE dst[MNN_INPUT_DIM_0][MNN_INPUT_DIM_1][MNN_INPUT_DIM_2])
{
    scanf("%lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf %lf", &tmp_input[0][0][0], &tmp_input[0][1][0], &tmp_input[0][2][0], &tmp_input[0][3][0], &tmp_input[0][4][0], &tmp_input[0][5][0], &tmp_input[0][6][0], &tmp_input[0][7][0], &tmp_input[0][8][0], &tmp_input[0][9][0], &tmp_input[0][10][0], &tmp_input[0][11][0], &tmp_input[0][12][0], &tmp_input[0][13][0], &tmp_input[0][14][0], &tmp_input[0][15][0], &tmp_input[0][16][0], &tmp_input[0][17][0], &tmp_input[0][18][0], &tmp_input[0][19][0], &tmp_input[0][20][0], &tmp_input[0][21][0], &tmp_input[0][22][0], &tmp_input[0][23][0], &tmp_input[0][24][0], &tmp_input[0][25][0], &tmp_input[0][26][0], &tmp_input[0][27][0], &tmp_input[1][0][0], &tmp_input[1][1][0], &tmp_input[1][2][0], &tmp_input[1][3][0], &tmp_input[1][4][0], &tmp_input[1][5][0], &tmp_input[1][6][0], &tmp_input[1][7][0], &tmp_input[1][8][0], &tmp_input[1][9][0], &tmp_input[1][10][0], &tmp_input[1][11][0], &tmp_input[1][12][0], &tmp_input[1][13][0], &tmp_input[1][14][0], &tmp_input[1][15][0], &tmp_input[1][16][0], &tmp_input[1][17][0], &tmp_input[1][18][0], &tmp_input[1][19][0], &tmp_input[1][20][0], &tmp_input[1][21][0], &tmp_input[1][22][0], &tmp_input[1][23][0], &tmp_input[1][24][0], &tmp_input[1][25][0], &tmp_input[1][26][0], &tmp_input[1][27][0], &tmp_input[2][0][0], &tmp_input[2][1][0], &tmp_input[2][2][0], &tmp_input[2][3][0], &tmp_input[2][4][0], &tmp_input[2][5][0], &tmp_input[2][6][0], &tmp_input[2][7][0], &tmp_input[2][8][0], &tmp_input[2][9][0], &tmp_input[2][10][0], &tmp_input[2][11][0], &tmp_input[2][12][0], &tmp_input[2][13][0], &tmp_input[2][14][0], &tmp_input[2][15][0], &tmp_input[2][16][0], &tmp_input[2][17][0], &tmp_input[2][18][0], &tmp_input[2][19][0], &tmp_input[2][20][0], &tmp_input[2][21][0], &tmp_input[2][22][0], &tmp_input[2][23][0], &tmp_input[2][24][0], &tmp_input[2][25][0], &tmp_input[2][26][0], &tmp_input[2][27][0], &tmp_input[3][0][0], &tmp_input[3][1][0], &tmp_input[3][2][0], &tmp_input[3][3][0], &tmp_input[3][4][0], &tmp_input[3][5][0], &tmp_input[3][6][0], &tmp_input[3][7][0], &tmp_input[3][8][0], &tmp_input[3][9][0], &tmp_input[3][10][0], &tmp_input[3][11][0], &tmp_input[3][12][0], &tmp_input[3][13][0], &tmp_input[3][14][0], &tmp_input[3][15][0], &tmp_input[3][16][0], &tmp_input[3][17][0], &tmp_input[3][18][0], &tmp_input[3][19][0], &tmp_input[3][20][0], &tmp_input[3][21][0], &tmp_input[3][22][0], &tmp_input[3][23][0], &tmp_input[3][24][0], &tmp_input[3][25][0], &tmp_input[3][26][0], &tmp_input[3][27][0], &tmp_input[4][0][0], &tmp_input[4][1][0], &tmp_input[4][2][0], &tmp_input[4][3][0], &tmp_input[4][4][0], &tmp_input[4][5][0], &tmp_input[4][6][0], &tmp_input[4][7][0], &tmp_input[4][8][0], &tmp_input[4][9][0], &tmp_input[4][10][0], &tmp_input[4][11][0], &tmp_input[4][12][0], &tmp_input[4][13][0], &tmp_input[4][14][0], &tmp_input[4][15][0], &tmp_input[4][16][0], &tmp_input[4][17][0], &tmp_input[4][18][0], &tmp_input[4][19][0], &tmp_input[4][20][0], &tmp_input[4][21][0], &tmp_input[4][22][0], &tmp_input[4][23][0], &tmp_input[4][24][0], &tmp_input[4][25][0], &tmp_input[4][26][0], &tmp_input[4][27][0], &tmp_input[5][0][0], &tmp_input[5][1][0], &tmp_input[5][2][0], &tmp_input[5][3][0], &tmp_input[5][4][0], &tmp_input[5][5][0], &tmp_input[5][6][0], &tmp_input[5][7][0], &tmp_input[5][8][0], &tmp_input[5][9][0], &tmp_input[5][10][0], &tmp_input[5][11][0], &tmp_input[5][12][0], &tmp_input[5][13][0], &tmp_input[5][14][0], &tmp_input[5][15][0], &tmp_input[5][16][0], &tmp_input[5][17][0], &tmp_input[5][18][0], &tmp_input[5][19][0], &tmp_input[5][20][0], &tmp_input[5][21][0], &tmp_input[5][22][0], &tmp_input[5][23][0], &tmp_input[5][24][0], &tmp_input[5][25][0], &tmp_input[5][26][0], &tmp_input[5][27][0], &tmp_input[6][0][0], &tmp_input[6][1][0], &tmp_input[6][2][0], &tmp_input[6][3][0], &tmp_input[6][4][0], &tmp_input[6][5][0], &tmp_input[6][6][0], &tmp_input[6][7][0], &tmp_input[6][8][0], &tmp_input[6][9][0], &tmp_input[6][10][0], &tmp_input[6][11][0], &tmp_input[6][12][0], &tmp_input[6][13][0], &tmp_input[6][14][0], &tmp_input[6][15][0], &tmp_input[6][16][0], &tmp_input[6][17][0], &tmp_input[6][18][0], &tmp_input[6][19][0], &tmp_input[6][20][0], &tmp_input[6][21][0], &tmp_input[6][22][0], &tmp_input[6][23][0], &tmp_input[6][24][0], &tmp_input[6][25][0], &tmp_input[6][26][0], &tmp_input[6][27][0], &tmp_input[7][0][0], &tmp_input[7][1][0], &tmp_input[7][2][0], &tmp_input[7][3][0], &tmp_input[7][4][0], &tmp_input[7][5][0], &tmp_input[7][6][0], &tmp_input[7][7][0], &tmp_input[7][8][0], &tmp_input[7][9][0], &tmp_input[7][10][0], &tmp_input[7][11][0], &tmp_input[7][12][0], &tmp_input[7][13][0], &tmp_input[7][14][0], &tmp_input[7][15][0], &tmp_input[7][16][0], &tmp_input[7][17][0], &tmp_input[7][18][0], &tmp_input[7][19][0], &tmp_input[7][20][0], &tmp_input[7][21][0], &tmp_input[7][22][0], &tmp_input[7][23][0], &tmp_input[7][24][0], &tmp_input[7][25][0], &tmp_input[7][26][0], &tmp_input[7][27][0], &tmp_input[8][0][0], &tmp_input[8][1][0], &tmp_input[8][2][0], &tmp_input[8][3][0], &tmp_input[8][4][0], &tmp_input[8][5][0], &tmp_input[8][6][0], &tmp_input[8][7][0], &tmp_input[8][8][0], &tmp_input[8][9][0], &tmp_input[8][10][0], &tmp_input[8][11][0], &tmp_input[8][12][0], &tmp_input[8][13][0], &tmp_input[8][14][0], &tmp_input[8][15][0], &tmp_input[8][16][0], &tmp_input[8][17][0], &tmp_input[8][18][0], &tmp_input[8][19][0], &tmp_input[8][20][0], &tmp_input[8][21][0], &tmp_input[8][22][0], &tmp_input[8][23][0], &tmp_input[8][24][0], &tmp_input[8][25][0], &tmp_input[8][26][0], &tmp_input[8][27][0], &tmp_input[9][0][0], &tmp_input[9][1][0], &tmp_input[9][2][0], &tmp_input[9][3][0], &tmp_input[9][4][0], &tmp_input[9][5][0], &tmp_input[9][6][0], &tmp_input[9][7][0], &tmp_input[9][8][0], &tmp_input[9][9][0], &tmp_input[9][10][0], &tmp_input[9][11][0], &tmp_input[9][12][0], &tmp_input[9][13][0], &tmp_input[9][14][0], &tmp_input[9][15][0], &tmp_input[9][16][0], &tmp_input[9][17][0], &tmp_input[9][18][0], &tmp_input[9][19][0], &tmp_input[9][20][0], &tmp_input[9][21][0], &tmp_input[9][22][0], &tmp_input[9][23][0], &tmp_input[9][24][0], &tmp_input[9][25][0], &tmp_input[9][26][0], &tmp_input[9][27][0], &tmp_input[10][0][0], &tmp_input[10][1][0], &tmp_input[10][2][0], &tmp_input[10][3][0], &tmp_input[10][4][0], &tmp_input[10][5][0], &tmp_input[10][6][0], &tmp_input[10][7][0], &tmp_input[10][8][0], &tmp_input[10][9][0], &tmp_input[10][10][0], &tmp_input[10][11][0], &tmp_input[10][12][0], &tmp_input[10][13][0], &tmp_input[10][14][0], &tmp_input[10][15][0], &tmp_input[10][16][0], &tmp_input[10][17][0], &tmp_input[10][18][0], &tmp_input[10][19][0], &tmp_input[10][20][0], &tmp_input[10][21][0], &tmp_input[10][22][0], &tmp_input[10][23][0], &tmp_input[10][24][0], &tmp_input[10][25][0], &tmp_input[10][26][0], &tmp_input[10][27][0], &tmp_input[11][0][0], &tmp_input[11][1][0], &tmp_input[11][2][0], &tmp_input[11][3][0], &tmp_input[11][4][0], &tmp_input[11][5][0], &tmp_input[11][6][0], &tmp_input[11][7][0], &tmp_input[11][8][0], &tmp_input[11][9][0], &tmp_input[11][10][0], &tmp_input[11][11][0], &tmp_input[11][12][0], &tmp_input[11][13][0], &tmp_input[11][14][0], &tmp_input[11][15][0], &tmp_input[11][16][0], &tmp_input[11][17][0], &tmp_input[11][18][0], &tmp_input[11][19][0], &tmp_input[11][20][0], &tmp_input[11][21][0], &tmp_input[11][22][0], &tmp_input[11][23][0], &tmp_input[11][24][0], &tmp_input[11][25][0], &tmp_input[11][26][0], &tmp_input[11][27][0], &tmp_input[12][0][0], &tmp_input[12][1][0], &tmp_input[12][2][0], &tmp_input[12][3][0], &tmp_input[12][4][0], &tmp_input[12][5][0], &tmp_input[12][6][0], &tmp_input[12][7][0], &tmp_input[12][8][0], &tmp_input[12][9][0], &tmp_input[12][10][0], &tmp_input[12][11][0], &tmp_input[12][12][0], &tmp_input[12][13][0], &tmp_input[12][14][0], &tmp_input[12][15][0], &tmp_input[12][16][0], &tmp_input[12][17][0], &tmp_input[12][18][0], &tmp_input[12][19][0], &tmp_input[12][20][0], &tmp_input[12][21][0], &tmp_input[12][22][0], &tmp_input[12][23][0], &tmp_input[12][24][0], &tmp_input[12][25][0], &tmp_input[12][26][0], &tmp_input[12][27][0], &tmp_input[13][0][0], &tmp_input[13][1][0], &tmp_input[13][2][0], &tmp_input[13][3][0], &tmp_input[13][4][0], &tmp_input[13][5][0], &tmp_input[13][6][0], &tmp_input[13][7][0], &tmp_input[13][8][0], &tmp_input[13][9][0], &tmp_input[13][10][0], &tmp_input[13][11][0], &tmp_input[13][12][0], &tmp_input[13][13][0], &tmp_input[13][14][0], &tmp_input[13][15][0], &tmp_input[13][16][0], &tmp_input[13][17][0], &tmp_input[13][18][0], &tmp_input[13][19][0], &tmp_input[13][20][0], &tmp_input[13][21][0], &tmp_input[13][22][0], &tmp_input[13][23][0], &tmp_input[13][24][0], &tmp_input[13][25][0], &tmp_input[13][26][0], &tmp_input[13][27][0], &tmp_input[14][0][0], &tmp_input[14][1][0], &tmp_input[14][2][0], &tmp_input[14][3][0], &tmp_input[14][4][0], &tmp_input[14][5][0], &tmp_input[14][6][0], &tmp_input[14][7][0], &tmp_input[14][8][0], &tmp_input[14][9][0], &tmp_input[14][10][0], &tmp_input[14][11][0], &tmp_input[14][12][0], &tmp_input[14][13][0], &tmp_input[14][14][0], &tmp_input[14][15][0], &tmp_input[14][16][0], &tmp_input[14][17][0], &tmp_input[14][18][0], &tmp_input[14][19][0], &tmp_input[14][20][0], &tmp_input[14][21][0], &tmp_input[14][22][0], &tmp_input[14][23][0], &tmp_input[14][24][0], &tmp_input[14][25][0], &tmp_input[14][26][0], &tmp_input[14][27][0], &tmp_input[15][0][0], &tmp_input[15][1][0], &tmp_input[15][2][0], &tmp_input[15][3][0], &tmp_input[15][4][0], &tmp_input[15][5][0], &tmp_input[15][6][0], &tmp_input[15][7][0], &tmp_input[15][8][0], &tmp_input[15][9][0], &tmp_input[15][10][0], &tmp_input[15][11][0], &tmp_input[15][12][0], &tmp_input[15][13][0], &tmp_input[15][14][0], &tmp_input[15][15][0], &tmp_input[15][16][0], &tmp_input[15][17][0], &tmp_input[15][18][0], &tmp_input[15][19][0], &tmp_input[15][20][0], &tmp_input[15][21][0], &tmp_input[15][22][0], &tmp_input[15][23][0], &tmp_input[15][24][0], &tmp_input[15][25][0], &tmp_input[15][26][0], &tmp_input[15][27][0], &tmp_input[16][0][0], &tmp_input[16][1][0], &tmp_input[16][2][0], &tmp_input[16][3][0], &tmp_input[16][4][0], &tmp_input[16][5][0], &tmp_input[16][6][0], &tmp_input[16][7][0], &tmp_input[16][8][0], &tmp_input[16][9][0], &tmp_input[16][10][0], &tmp_input[16][11][0], &tmp_input[16][12][0], &tmp_input[16][13][0], &tmp_input[16][14][0], &tmp_input[16][15][0], &tmp_input[16][16][0], &tmp_input[16][17][0], &tmp_input[16][18][0], &tmp_input[16][19][0], &tmp_input[16][20][0], &tmp_input[16][21][0], &tmp_input[16][22][0], &tmp_input[16][23][0], &tmp_input[16][24][0], &tmp_input[16][25][0], &tmp_input[16][26][0], &tmp_input[16][27][0], &tmp_input[17][0][0], &tmp_input[17][1][0], &tmp_input[17][2][0], &tmp_input[17][3][0], &tmp_input[17][4][0], &tmp_input[17][5][0], &tmp_input[17][6][0], &tmp_input[17][7][0], &tmp_input[17][8][0], &tmp_input[17][9][0], &tmp_input[17][10][0], &tmp_input[17][11][0], &tmp_input[17][12][0], &tmp_input[17][13][0], &tmp_input[17][14][0], &tmp_input[17][15][0], &tmp_input[17][16][0], &tmp_input[17][17][0], &tmp_input[17][18][0], &tmp_input[17][19][0], &tmp_input[17][20][0], &tmp_input[17][21][0], &tmp_input[17][22][0], &tmp_input[17][23][0], &tmp_input[17][24][0], &tmp_input[17][25][0], &tmp_input[17][26][0], &tmp_input[17][27][0], &tmp_input[18][0][0], &tmp_input[18][1][0], &tmp_input[18][2][0], &tmp_input[18][3][0], &tmp_input[18][4][0], &tmp_input[18][5][0], &tmp_input[18][6][0], &tmp_input[18][7][0], &tmp_input[18][8][0], &tmp_input[18][9][0], &tmp_input[18][10][0], &tmp_input[18][11][0], &tmp_input[18][12][0], &tmp_input[18][13][0], &tmp_input[18][14][0], &tmp_input[18][15][0], &tmp_input[18][16][0], &tmp_input[18][17][0], &tmp_input[18][18][0], &tmp_input[18][19][0], &tmp_input[18][20][0], &tmp_input[18][21][0], &tmp_input[18][22][0], &tmp_input[18][23][0], &tmp_input[18][24][0], &tmp_input[18][25][0], &tmp_input[18][26][0], &tmp_input[18][27][0], &tmp_input[19][0][0], &tmp_input[19][1][0], &tmp_input[19][2][0], &tmp_input[19][3][0], &tmp_input[19][4][0], &tmp_input[19][5][0], &tmp_input[19][6][0], &tmp_input[19][7][0], &tmp_input[19][8][0], &tmp_input[19][9][0], &tmp_input[19][10][0], &tmp_input[19][11][0], &tmp_input[19][12][0], &tmp_input[19][13][0], &tmp_input[19][14][0], &tmp_input[19][15][0], &tmp_input[19][16][0], &tmp_input[19][17][0], &tmp_input[19][18][0], &tmp_input[19][19][0], &tmp_input[19][20][0], &tmp_input[19][21][0], &tmp_input[19][22][0], &tmp_input[19][23][0], &tmp_input[19][24][0], &tmp_input[19][25][0], &tmp_input[19][26][0], &tmp_input[19][27][0], &tmp_input[20][0][0], &tmp_input[20][1][0], &tmp_input[20][2][0], &tmp_input[20][3][0], &tmp_input[20][4][0], &tmp_input[20][5][0], &tmp_input[20][6][0], &tmp_input[20][7][0], &tmp_input[20][8][0], &tmp_input[20][9][0], &tmp_input[20][10][0], &tmp_input[20][11][0], &tmp_input[20][12][0], &tmp_input[20][13][0], &tmp_input[20][14][0], &tmp_input[20][15][0], &tmp_input[20][16][0], &tmp_input[20][17][0], &tmp_input[20][18][0], &tmp_input[20][19][0], &tmp_input[20][20][0], &tmp_input[20][21][0], &tmp_input[20][22][0], &tmp_input[20][23][0], &tmp_input[20][24][0], &tmp_input[20][25][0], &tmp_input[20][26][0], &tmp_input[20][27][0], &tmp_input[21][0][0], &tmp_input[21][1][0], &tmp_input[21][2][0], &tmp_input[21][3][0], &tmp_input[21][4][0], &tmp_input[21][5][0], &tmp_input[21][6][0], &tmp_input[21][7][0], &tmp_input[21][8][0], &tmp_input[21][9][0], &tmp_input[21][10][0], &tmp_input[21][11][0], &tmp_input[21][12][0], &tmp_input[21][13][0], &tmp_input[21][14][0], &tmp_input[21][15][0], &tmp_input[21][16][0], &tmp_input[21][17][0], &tmp_input[21][18][0], &tmp_input[21][19][0], &tmp_input[21][20][0], &tmp_input[21][21][0], &tmp_input[21][22][0], &tmp_input[21][23][0], &tmp_input[21][24][0], &tmp_input[21][25][0], &tmp_input[21][26][0], &tmp_input[21][27][0], &tmp_input[22][0][0], &tmp_input[22][1][0], &tmp_input[22][2][0], &tmp_input[22][3][0], &tmp_input[22][4][0], &tmp_input[22][5][0], &tmp_input[22][6][0], &tmp_input[22][7][0], &tmp_input[22][8][0], &tmp_input[22][9][0], &tmp_input[22][10][0], &tmp_input[22][11][0], &tmp_input[22][12][0], &tmp_input[22][13][0], &tmp_input[22][14][0], &tmp_input[22][15][0], &tmp_input[22][16][0], &tmp_input[22][17][0], &tmp_input[22][18][0], &tmp_input[22][19][0], &tmp_input[22][20][0], &tmp_input[22][21][0], &tmp_input[22][22][0], &tmp_input[22][23][0], &tmp_input[22][24][0], &tmp_input[22][25][0], &tmp_input[22][26][0], &tmp_input[22][27][0], &tmp_input[23][0][0], &tmp_input[23][1][0], &tmp_input[23][2][0], &tmp_input[23][3][0], &tmp_input[23][4][0], &tmp_input[23][5][0], &tmp_input[23][6][0], &tmp_input[23][7][0], &tmp_input[23][8][0], &tmp_input[23][9][0], &tmp_input[23][10][0], &tmp_input[23][11][0], &tmp_input[23][12][0], &tmp_input[23][13][0], &tmp_input[23][14][0], &tmp_input[23][15][0], &tmp_input[23][16][0], &tmp_input[23][17][0], &tmp_input[23][18][0], &tmp_input[23][19][0], &tmp_input[23][20][0], &tmp_input[23][21][0], &tmp_input[23][22][0], &tmp_input[23][23][0], &tmp_input[23][24][0], &tmp_input[23][25][0], &tmp_input[23][26][0], &tmp_input[23][27][0], &tmp_input[24][0][0], &tmp_input[24][1][0], &tmp_input[24][2][0], &tmp_input[24][3][0], &tmp_input[24][4][0], &tmp_input[24][5][0], &tmp_input[24][6][0], &tmp_input[24][7][0], &tmp_input[24][8][0], &tmp_input[24][9][0], &tmp_input[24][10][0], &tmp_input[24][11][0], &tmp_input[24][12][0], &tmp_input[24][13][0], &tmp_input[24][14][0], &tmp_input[24][15][0], &tmp_input[24][16][0], &tmp_input[24][17][0], &tmp_input[24][18][0], &tmp_input[24][19][0], &tmp_input[24][20][0], &tmp_input[24][21][0], &tmp_input[24][22][0], &tmp_input[24][23][0], &tmp_input[24][24][0], &tmp_input[24][25][0], &tmp_input[24][26][0], &tmp_input[24][27][0], &tmp_input[25][0][0], &tmp_input[25][1][0], &tmp_input[25][2][0], &tmp_input[25][3][0], &tmp_input[25][4][0], &tmp_input[25][5][0], &tmp_input[25][6][0], &tmp_input[25][7][0], &tmp_input[25][8][0], &tmp_input[25][9][0], &tmp_input[25][10][0], &tmp_input[25][11][0], &tmp_input[25][12][0], &tmp_input[25][13][0], &tmp_input[25][14][0], &tmp_input[25][15][0], &tmp_input[25][16][0], &tmp_input[25][17][0], &tmp_input[25][18][0], &tmp_input[25][19][0], &tmp_input[25][20][0], &tmp_input[25][21][0], &tmp_input[25][22][0], &tmp_input[25][23][0], &tmp_input[25][24][0], &tmp_input[25][25][0], &tmp_input[25][26][0], &tmp_input[25][27][0], &tmp_input[26][0][0], &tmp_input[26][1][0], &tmp_input[26][2][0], &tmp_input[26][3][0], &tmp_input[26][4][0], &tmp_input[26][5][0], &tmp_input[26][6][0], &tmp_input[26][7][0], &tmp_input[26][8][0], &tmp_input[26][9][0], &tmp_input[26][10][0], &tmp_input[26][11][0], &tmp_input[26][12][0], &tmp_input[26][13][0], &tmp_input[26][14][0], &tmp_input[26][15][0], &tmp_input[26][16][0], &tmp_input[26][17][0], &tmp_input[26][18][0], &tmp_input[26][19][0], &tmp_input[26][20][0], &tmp_input[26][21][0], &tmp_input[26][22][0], &tmp_input[26][23][0], &tmp_input[26][24][0], &tmp_input[26][25][0], &tmp_input[26][26][0], &tmp_input[26][27][0], &tmp_input[27][0][0], &tmp_input[27][1][0], &tmp_input[27][2][0], &tmp_input[27][3][0], &tmp_input[27][4][0], &tmp_input[27][5][0], &tmp_input[27][6][0], &tmp_input[27][7][0], &tmp_input[27][8][0], &tmp_input[27][9][0], &tmp_input[27][10][0], &tmp_input[27][11][0], &tmp_input[27][12][0], &tmp_input[27][13][0], &tmp_input[27][14][0], &tmp_input[27][15][0], &tmp_input[27][16][0], &tmp_input[27][17][0], &tmp_input[27][18][0], &tmp_input[27][19][0], &tmp_input[27][20][0], &tmp_input[27][21][0], &tmp_input[27][22][0], &tmp_input[27][23][0], &tmp_input[27][24][0], &tmp_input[27][25][0], &tmp_input[27][26][0], &tmp_input[27][27][0]);
    for (int input_dim_0 = 0; input_dim_0 < MNN_INPUT_DIM_0; input_dim_0++)
    {
        for (int input_dim_1 = 0; input_dim_1 < MNN_INPUT_DIM_1; input_dim_1++)
        {
            for (int input_dim_2 = 0; input_dim_2 < MNN_INPUT_DIM_2; input_dim_2++)
            {
                dst[input_dim_0][input_dim_1][input_dim_2] = FROM_DBL(tmp_input[input_dim_0][input_dim_1][input_dim_2]);
            }
        }
    }
}


void copy_input_arr(NN_NUM_TYPE src[MNN_INPUT_DIM_0][MNN_INPUT_DIM_1][MNN_INPUT_DIM_2], NN_NUM_TYPE dst[MNN_INPUT_DIM_0][MNN_INPUT_DIM_1][MNN_INPUT_DIM_2])
{
    for (int input_dim_0 = 0; input_dim_0 < MNN_INPUT_DIM_0; input_dim_0++)
    {
        for (int input_dim_1 = 0; input_dim_1 < MNN_INPUT_DIM_1; input_dim_1++)
        {
            for (int input_dim_2 = 0; input_dim_2 < MNN_INPUT_DIM_2; input_dim_2++)
            {
                dst[input_dim_0][input_dim_1][input_dim_2] = src[input_dim_0][input_dim_1][input_dim_2];
            }
        }
    }
}


void copy_output_arr(NN_NUM_TYPE src[MNN_OUTPUT_DIM_0], NN_NUM_TYPE dst[MNN_OUTPUT_DIM_0])
{
    for (int output_dim_0 = 0; output_dim_0 < MNN_OUTPUT_DIM_0; output_dim_0++)
    {
        dst[output_dim_0] = src[output_dim_0];
    }
}





int run_single(
    NN_META_DATA *mnn_data,
    NN_NUM_TYPE test_case_data[MNN_INPUT_DIM_0][MNN_INPUT_DIM_1][MNN_INPUT_DIM_2],
    int input_buffer_index,
    NN_NUM_TYPE results[MNN_OUTPUT_DIM_0],
    bool copy_input,
    bool copy_output
)
{
    // Only load new input for the first test_case_num ticks 
    if (copy_input)
    {
        copy_input_arr(test_case_data, (void *)&mnn_data->inputs[input_buffer_index]);
    }

    // Wait for MNN to finish current step in pipeline, get the next safe writing index for the input buffer
    input_buffer_index = mnn_response(mnn_data);

    // Only print output at (and after) NN_META_PL_LAG ticks
    if (copy_output)
    {
        copy_output_arr(mnn_data->outputs, results);
    }

    return input_buffer_index;
}


// A demonstration of how data should be passed to and retrieved from the MNN during pipelined operation
void run_batch(
    NN_META_DATA *mnn_data,
    int test_case_num,
    NN_NUM_TYPE test_data[test_case_num][MNN_INPUT_DIM_0][MNN_INPUT_DIM_1][MNN_INPUT_DIM_2],
    int input_buffer_index,
    NN_NUM_TYPE results[test_case_num][MNN_OUTPUT_DIM_0]
)
{
    bool copy_input, copy_output;
    for (int tick_index = 0; tick_index < test_case_num + NN_META_PL_LAG; tick_index++)
    {
        copy_input = tick_index < test_case_num;
        copy_output = tick_index >= NN_META_PL_LAG;
        input_buffer_index = run_single(mnn_data, test_data[tick_index], input_buffer_index, results[tick_index - NN_META_PL_LAG], copy_input, copy_output);
    }
}


NN_META_DATA mnn_data;
int main(void)
{
    int test_index;
    int test_case_num;
    NN_NUM_TYPE *test_data;
    NN_NUM_TYPE *results;
    int input_buffer_index;
    int output_buffer_index = 0;
    int input_len = MNN_INPUT_DIM_0 * MNN_INPUT_DIM_1 * MNN_INPUT_DIM_2;
    int output_len = MNN_OUTPUT_DIM_0;

    scanf("%d", &test_case_num);
    test_data = malloc(test_case_num * input_len * sizeof(NN_NUM_TYPE));
    
    for (test_index = 0; test_index < test_case_num; test_index++)
    {
        read_input_data((void *)&test_data[test_index * input_len]);
    }

    results = malloc(test_case_num * output_len * sizeof(NN_NUM_TYPE));
    input_buffer_index = mnn_init(&mnn_data);
    run_batch(&mnn_data, test_case_num, (void *)test_data, input_buffer_index, (void *)results);

    for (output_buffer_index = 0; output_buffer_index < test_case_num; output_buffer_index++)
    {
        print_output_arr((void *)&results[output_buffer_index * output_len]);
    }

    

    mnn_free(&mnn_data);
    free(test_data);
    free(results);
    
}